from sklearn.tree import DecisionTreeClassifier
from sklearn.model_selection import train_test_split
from sklearn.metrics import accuracy_score
import matplotlib.pyplot as plt
from sklearn.tree import plot_tree

# 加载数据
X = [[0.77892486, 0.54372894, 0.41264868, 0.01639887, 0.86088791, 0.05896586, 0.10556941, 0.62822463, 0.79826166, 0.40622372, 0.41253157, 0.02784336, 0.57437728, 0.11609364, 0.65686741, 0.79306405, 0.16513647, 0.49524408, 0.91573481, 0.66917094],
     [0.37975424, 0.42993945, 0.31184909, 0.38828752, 0.35221159, 0.14260398, 0.39937961, 0.93223783, 0.60460696, 0.9734151 , 0.09487125, 0.54434024, 0.25282297, 0.10014705, 0.75528709, 0.01943338, 0.4065352 , 0.60784683, 0.95068312, 0.78707973],
     [0.57297345, 0.34459551, 0.01807923, 0.26118943, 0.28988005, 0.30157459, 0.37446791, 0.38129334, 0.88090483, 0.74932593, 0.70193625, 0.36453809, 0.12529335, 0.05485578, 0.96366718, 0.93092217, 0.27105731, 0.11720017, 0.75939617, 0.53364539],
     [0.15650278, 0.38034738, 0.87225488, 0.37488222, 0.76220278, 0.95738415, 0.65743037, 0.15647302, 0.53821017, 0.25306903, 0.38254562, 0.0473277 , 0.5846099 , 0.08731611, 0.45680368, 0.95109533, 0.2721612 , 0.0849954 , 0.09584667, 0.58972816],
     [0.49028715, 0.70617041, 0.47519024, 0.29152558, 0.63658572, 0.88852018, 0.88210159, 0.49573931, 0.77972441, 0.5501026 , 0.16781253, 0.2940847 , 0.3501671 , 0.63963837, 0.02900101, 0.12834974, 0.66377748, 0.88356005, 0.4594083 , 0.14364268]
     ]
y = [1, 1, 0, 1, 1]

# 训练模型并评估准确率
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)
tree_clf = DecisionTreeClassifier(max_depth=3)
tree_clf.fit(X_train, y_train)
y_pred = tree_clf.predict(X_test)
accuracy = accuracy_score(y_test, y_pred)
print(f"Accuracy: {accuracy}")

# 展示决策树
plt.figure(figsize=(12, 12))
plt.title("Decision Tree")
plt.xlabel("Feature Index")
plt.ylabel("Tree Depth")
plot_tree(tree_clf, filled=True)
plt.show()